select * from uber_ride;

-- where coluumn is null put value based on conditions 

update uber_ride
set  `Payment Method` ='unknown'
where `Payment Method` is Null;

update uber_ride
set `Customer Rating` = 0
where `Customer Rating` is Null;

update uber_ride
set `Driver Ratings` =0 
where `Driver Ratings` is Null;
 
update uber_ride
set `Ride Distance` = 0
where `Ride Distance` is Null;

update uber_ride
set `Booking Value` = 0 
where `Booking Value` is NUll;

update uber_ride
set `Incomplete Rides` = 0
where `Incomplete Rides` is Null;

update uber_ride 
set `Cancelled Rides by Driver` = 0
where `Cancelled Rides by Driver` is Null;

update uber_ride 
set `Cancelled Rides by Customer` = 0
where `Cancelled Rides by Customer` is null;

update uber_ride
set `Avg CTAT` = 0
where `Avg CTAT` is Null;

update uber_ride 
set `Avg VTAT` = 0
where `Avg VTAT` is Null;

update uber_ride 
set `Reason for cancelling by Customer` = 'Not Applicable'
where `Reason for cancelling by Customer`is Null; 

update uber_ride
set `Driver Cancellation Reason` = 'Not Applicable'
where `Driver cancellation Reason` is Null;

Update uber_ride 
set `Incomplete Rides Reason` = 'Not Applicable'
where `Incomplete Rides Reason` is Null;

select * from uber_ride;

-- Total ride
select count(*) as total_rides from uber_ride;

-- Total revenue generated 
select sum(`Booking Value`) as total_revenue from uber_ride;

-- Average fare per ride
select avg(`Booking Value`) avg_fare from uber_ride;

-- Ride per day 
select date(Date) as ride_day,count(*) as ride_per_day
from uber_ride
group by ride_day
order by ride_day;

-- Revenue per day
select Date as ride_day,sum(`Booking Value`) as revenue_per_day
from uber_ride group by ride_day order by ride_day;

-- Top five passenger by spending
select `Customer ID` as customer_id,sum(`Booking Value`) as total_spent from uber_ride
group by customer_id order by total_spent desc limit 5;

-- Most popular pickup location
select `Pickup Location`,count(*) as most_pickup from uber_ride
group by `Pickup Location` order by most_pickup desc;

-- Average ride distance
select avg(`Ride Distance`) as avg_ride_distance from uber_ride;

-- Average driver rating 
select avg(`Driver Ratings`) as avg_driver_rating from uber_ride;

-- Logest ride by distance
select * ,`Ride Distance` as ride_distance from uber_ride
order by ride_distance desc ;

-- Highest fare collected 
select `Booking ID`,`Booking Status`,`Vehicle Type`,`Booking Value` as fare from uber_ride
order by fare desc limit 1;
